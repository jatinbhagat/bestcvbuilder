import{c as l}from"./index-ARlhr7Pl-v2.js";const d="https://rletapisdadphfdmqdxu.supabase.co",u="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJsZXRhcGlzZGFkcGhmZG1xZHh1Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQxMTUzOTAsImV4cCI6MjA2OTY5MTM5MH0.oXw8UtxIQDSt-aWyHKEmX20DGYGrzcovoOtl5dOqVHA",a=l(d,u);class g{static async saveAnalysisResult(t,r){try{const{data:e,error:o}=await a.from("analysis_results").insert({user_id:t,original_score:r.score,analysis_data:r,created_at:new Date().toISOString()});if(o)throw o;return e}catch(e){throw console.error("Save analysis error:",e),e}}static async getAnalysisHistory(t){try{const{data:r,error:e}=await a.from("analysis_results").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(e)throw e;return r}catch(r){throw console.error("Get analysis history error:",r),r}}static async savePaymentRecord(t,r){try{const{data:e,error:o}=await a.from("payments").insert({user_id:t,amount:r.amount,status:r.status,payment_method:r.method,created_at:new Date().toISOString()});if(o)throw o;return e}catch(e){throw console.error("Save payment error:",e),e}}static async saveFeedback(t,r){try{const{data:e,error:o}=await a.from("feedback").insert({user_id:t,rating:r.rating,comment:r.comment,created_at:new Date().toISOString()});if(o)throw o;return e}catch(e){throw console.error("Save feedback error:",e),e}}static async saveJobAnalysis(t,r){try{console.log("üìä Saving job analysis to database...");const{data:e,error:o}=await a.from("job_analysis").insert({user_id:t,role_title:r.role_title,company_name:r.company_name,job_description:r.job_description,extracted_requirements:r.extracted_requirements,user_expectations:r.user_expectations,analysis_score:r.analysis_score,matching_keywords:r.matching_keywords,created_at:new Date().toISOString()});if(o)throw console.error("‚ùå Job analysis save failed:",o),o;return console.log("‚úÖ Job analysis saved successfully:",e),e}catch(e){throw console.error("Job analysis save error:",e),e}}static async logActivity(t,r,e=null){try{if(!t){const{data:{user:c}}=await a.auth.getUser();t=(c==null?void 0:c.id)||"anonymous"}const o={user_id:t,activity_type:r,activity_data:e,ip_address:null,user_agent:navigator.userAgent,timestamp:new Date().toISOString()};console.log("üìä Logging activity:",r,e);const{data:n,error:s}=await a.from("activity_logs").insert(o);return s?(console.error("‚ùå Activity logging failed:",s),null):(console.log("‚úÖ Activity logged successfully:",r),n)}catch(o){return console.error("Activity logging error:",o),null}}}class y{static async uploadFile(t,r=null){try{const e=`${Date.now()}_${t.name}`,o=r?`users/${r}/${e}`:`uploads/${e}`;console.log("Uploading file:",e,"to path:",o),console.log("File info:",{name:t.name,type:t.type,size:t.size});const{data:n,error:s}=await a.storage.from("resumes").upload(o,t,{cacheControl:"3600",upsert:!0});if(s)throw console.error("‚ùå Upload failed:",s),new Error(`File upload failed: ${s.message}`);console.log("‚úÖ Upload successful:",n);const{data:c}=a.storage.from("resumes").getPublicUrl(o);return console.log("üìÅ Public URL generated:",c.publicUrl),c.publicUrl}catch(e){throw console.error("Upload file error:",e),e}}static async deleteFile(t){try{const{error:r}=await a.storage.from("resumes").remove([t]);if(r)throw r}catch(r){throw console.error("Delete file error:",r),r}}static getFileUrl(t){const{data:r}=a.storage.from("resumes").getPublicUrl(t);return r.publicUrl}}export{g as D,y as S,a as s};
